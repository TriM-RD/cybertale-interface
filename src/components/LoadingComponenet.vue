<template>
  <div v-if="active" class="d-flex justify-content-center align-items-center" :style="getStyle">
    <div id="preloader" v-if="showLogo">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="260.2612 126.253 455.1653 160.734" width="455.165px" height="160.734px">
        <linearGradient id="SVGID_1_" gradientUnits="userSpaceOnUse" x1="279.3087" y1="-2310.8616" x2="252.6762" y2="-2326.2378" gradientTransform="matrix(0.73, 0.6835, 0.6835, -0.73, 2085.468657, -1684.463257)">
          <stop offset="0" style="stop-color: #339c47" />
          <stop offset="1" style="stop-color: #1a7946" />
        </linearGradient>
        <linearGradient id="SVGID_2_" gradientUnits="userSpaceOnUse" x1="212.5085" y1="-2344.7891" x2="221.1928" y2="-2368.6489" gradientTransform="matrix(0.73, 0.6835, 0.6835, -0.73, 2085.468657, -1684.463257)">
          <stop offset="0" style="stop-color: #339c47" />
          <stop offset="1" style="stop-color: #1a7946" />
        </linearGradient>
        <linearGradient id="SVGID_3_" gradientUnits="userSpaceOnUse" x1="176.0234" y1="-2321.4502" x2="261.6273" y2="-2321.4502" gradientTransform="matrix(0.73, 0.6835, 0.6835, -0.73, 2085.468657, -1684.463257)">
          <stop offset="0" style="stop-color: #56ba59" />
          <stop offset="1" style="stop-color: #5ac2aa" />
        </linearGradient>
        <linearGradient id="SVGID_4_" gradientUnits="userSpaceOnUse" x1="246.1134" y1="-2370.9773" x2="253.0011" y2="-2331.9153" gradientTransform="matrix(0.73, 0.6835, 0.6835, -0.73, 2085.468657, -1684.463257)">
          <stop offset="0" style="stop-color: #56ba59" />
          <stop offset="1" style="stop-color: #5ac2aa" />
        </linearGradient>
        <path
            class="st5"
            id="bw"
            d="M 605.415 153.603 C 597.015 162.603 597.415 176.703 606.415 185.103 C 609.415 187.903 613.115 189.803 616.915 190.603 L 618.015 190.903 L 640.415 196.803 C 643.415 197.603 645.915 199.603 647.515 202.203 C 647.815 202.603 648.015 203.103 648.215 203.603 C 648.415 204.103 648.415 204.403 648.415 204.403 L 656.215 227.903 C 657.415 231.603 659.615 235.003 662.715 237.803 C 671.015 245.003 683.615 245.103 691.915 237.903 C 694.815 235.503 696.815 232.603 698.115 229.403 C 698.115 229.403 699.115 227.103 700.715 223.103 C 703.315 216.403 707.315 204.903 710.415 191.003 C 713.015 179.603 714.315 169.403 714.915 162.003 C 714.915 162.003 714.915 162.003 714.915 162.003 C 714.915 162.003 714.915 162.003 714.915 162.003 C 714.915 162.003 714.915 162.003 714.915 162.003 C 714.915 162.003 714.915 162.003 714.915 162.003 C 715.415 155.203 715.415 150.503 715.415 149.103 C 715.615 143.003 713.215 136.803 708.415 132.303 C 703.715 127.903 697.515 125.903 691.515 126.303 C 691.515 126.303 673.115 126.903 649.515 134.003 C 629.515 140.003 614.715 147.403 612.315 148.603 C 609.815 149.803 607.415 151.503 605.415 153.603 M 688.115 185.603 C 685.215 198.103 681.615 208.603 679.315 214.503 L 678.115 217.503 C 678.115 217.503 678.115 217.503 678.115 217.603 C 678.015 217.703 677.915 217.703 677.815 217.503 L 677.715 217.403 L 669.815 193.003 C 666.815 183.703 659.215 176.603 649.715 174.303 L 627.015 168.703 C 627.015 168.703 627.115 168.703 627.115 168.703 L 625.315 168.303 C 625.215 168.303 625.215 168.303 625.215 168.203 C 625.215 168.103 625.215 168.003 625.315 168.003 C 630.015 165.803 641.715 160.503 656.515 156.003 C 670.515 151.803 682.515 150.203 688.515 149.603 C 688.515 149.603 688.715 149.603 689.015 149.603 C 690.115 149.703 691.115 150.403 691.715 151.203 C 692.215 151.803 692.415 152.603 692.415 153.403 C 692.215 159.603 691.315 171.503 688.115 185.603 Z"
        />
        <path
            class="st0 color"
            fill="url(#SVGID_1_)"
            d="M 700.715 223.203 C 703.315 216.503 707.315 205.003 710.415 191.103 C 713.015 179.703 714.315 169.503 714.915 162.103 C 714.715 147.303 688.515 149.803 688.515 149.803 C 689.815 149.703 691.015 150.303 691.715 151.303 C 692.215 151.903 692.415 152.703 692.415 153.503 C 692.215 159.603 691.315 171.503 688.115 185.703 C 685.215 198.203 681.615 208.703 679.315 214.603 L 678.115 217.603 C 678.115 217.603 678.115 217.603 678.115 217.703 C 678.015 217.803 677.915 217.803 677.815 217.603 C 677.715 217.503 686.815 240.903 700.715 223.203 Z"
        />
        <path
            class="st1 color"
            fill="url(#SVGID_2_)"
            d="M 632.915 170.303 L 625.315 168.403 C 625.215 168.403 625.215 168.403 625.215 168.303 C 625.215 168.203 625.215 168.103 625.315 168.103 C 625.315 168.103 597.515 178.303 618.015 191.003 L 640.415 196.903 C 643.415 197.703 645.915 199.703 647.515 202.303 C 647.915 203.003 648.215 203.703 648.515 204.503 C 648.415 204.503 643.515 183.303 632.915 170.303 Z"
        />
        <path
            class="st2 color"
            fill="url(#SVGID_3_)"
            d="M 656.515 156.103 C 670.515 151.903 682.515 150.303 688.515 149.703 C 688.515 149.703 714.715 147.203 714.915 162.003 C 715.415 155.203 715.415 150.603 715.415 149.203 C 715.615 143.103 713.215 136.903 708.415 132.403 C 703.715 128.003 697.515 126.003 691.515 126.403 C 691.515 126.403 673.115 127.003 649.515 134.103 C 629.515 140.103 614.715 147.503 612.315 148.703 C 609.815 149.903 607.415 151.503 605.415 153.703 C 597.015 162.703 597.415 176.803 606.415 185.203 C 609.415 188.003 613.115 189.903 616.915 190.703 L 618.015 191.003 C 597.615 178.203 625.315 168.103 625.315 168.103 C 630.015 165.803 641.715 160.503 656.515 156.103 Z"
        />
        <path
            class="st3 color"
            fill="url(#SVGID_4_)"
            d="M 698.115 229.503 C 698.115 229.503 699.115 227.203 700.715 223.203 C 686.915 240.903 677.715 217.503 677.715 217.503 L 669.815 193.103 C 666.815 183.803 659.215 176.703 649.715 174.403 L 627.015 168.803 C 640.415 175.303 648.415 204.503 648.415 204.503 L 656.215 228.003 C 657.415 231.703 659.615 235.103 662.715 237.903 C 671.015 245.103 683.615 245.203 691.915 238.003 C 694.815 235.503 696.815 232.703 698.115 229.503 Z"
        />
        <path
            id="first"
            class="st4"
            d="M 313.866 155.503 C 314.366 156.403 314.166 157.503 313.366 158.103 L 304.166 165.303 C 302.866 166.303 301.066 166.103 299.966 164.803 C 297.366 161.603 294.366 159.903 290.366 159.903 C 283.766 159.903 279.466 164.603 279.466 171.303 C 279.466 178.003 283.766 182.703 290.366 182.703 C 294.366 182.703 297.366 180.903 299.966 177.803 C 300.966 176.603 302.766 176.303 304.066 177.303 L 313.366 184.303 C 314.166 184.903 314.366 186.003 313.866 186.903 C 309.266 195.003 300.866 200.003 290.166 200.003 C 273.866 200.303 259.966 187.103 260.266 171.303 C 259.966 155.303 273.866 142.203 290.166 142.403 C 300.766 142.403 309.166 147.403 313.866 155.503"
        />
        <path
            id="first"
            class="st4"
            d="M 376.666 144.103 L 390.066 144.103 C 392.166 144.103 393.866 145.803 393.866 147.903 C 393.866 148.103 394.066 148.203 394.266 148.103 C 398.166 144.603 403.066 142.803 408.966 142.803 C 415.666 142.803 420.866 145.003 424.766 149.603 C 424.866 149.703 424.966 149.703 425.066 149.603 C 429.466 145.303 435.866 142.703 442.866 142.703 C 455.866 142.703 464.066 151.503 464.066 165.103 L 464.066 198.603 C 463.966 198.803 463.866 198.903 463.666 198.903 L 445.266 198.903 C 445.166 198.903 445.066 198.803 445.066 198.703 L 445.066 167.803 C 445.066 162.603 441.966 159.703 437.266 159.703 C 432.766 159.703 429.666 162.703 429.666 167.803 L 429.666 196.803 C 429.666 197.903 428.766 198.803 427.666 198.803 L 412.866 198.803 C 411.766 198.803 410.866 197.903 410.866 196.803 L 410.866 167.803 C 410.866 162.603 407.766 159.703 403.066 159.703 C 398.566 159.703 395.466 162.703 395.466 167.803 L 395.466 198.603 C 395.466 198.703 395.366 198.803 395.266 198.803 L 382.666 198.803 C 379.366 198.803 376.666 196.103 376.666 192.803 L 376.666 144.103"
        />
        <path
            id="first"
            class="st4"
            d="M 472.766 145.003 L 484.866 145.003 C 487.566 145.003 489.766 147.203 489.766 149.903 L 489.766 150.103 C 489.766 150.303 490.066 150.403 490.166 150.203 C 493.566 145.803 498.666 143.703 505.466 143.703 C 520.766 143.703 531.766 155.603 531.766 172.303 C 531.866 188.903 520.766 201.103 505.566 201.103 C 499.966 201.103 495.466 199.603 491.866 196.403 C 491.766 196.303 491.466 196.403 491.466 196.603 L 491.466 212.603 L 483.066 212.603 C 477.266 212.603 472.566 207.903 472.566 202.103 L 472.566 145.203 C 472.566 145.103 472.666 145.003 472.766 145.003 M 501.866 160.803 C 496.066 160.803 491.266 164.903 491.266 172.303 C 491.266 179.803 496.066 184.003 501.866 184.003 C 507.666 184.003 512.566 179.703 512.566 172.403 C 512.566 165.103 507.866 160.803 501.866 160.803 Z"
        />
        <path
            id="first"
            class="st4"
            d="M 329.766 165.703 L 327.866 163.303 C 323.766 157.703 325.666 149.703 331.966 146.803 C 335.866 145.003 340.166 144.103 344.966 144.103 C 359.566 144.103 368.666 152.203 368.666 167.303 L 368.666 191.603 C 368.766 194.903 366.066 197.503 362.766 197.503 L 352.366 197.503 L 352.366 193.303 C 348.466 197.003 343.466 198.803 337.366 198.803 C 325.966 198.803 319.366 191.403 319.366 182.603 C 319.366 172.903 327.166 167.003 339.866 167.003 L 350.866 167.003 L 350.866 166.203 C 350.866 162.103 348.366 159.503 342.966 159.503 C 338.366 159.503 334.966 161.303 330.066 165.703 C 329.966 165.803 329.766 165.803 329.766 165.703 M 350.766 178.103 L 342.266 178.103 C 339.266 178.103 337.466 179.603 337.466 182.103 C 337.466 184.603 339.466 186.203 342.766 186.203 C 347.366 186.203 350.666 183.303 350.666 178.603 L 350.766 178.103 Z"
        />
        <path
            id="first"
            class="st4"
            d="M 453.004 268.12 C 459.004 268.12 463.704 263.82 463.704 256.52 C 463.704 249.22 458.804 244.92 453.004 244.92 C 447.204 244.92 442.404 249.12 442.404 256.62 C 442.404 264.02 447.204 268.12 453.004 268.12 Z M 423.904 283.82 C 423.804 283.82 423.704 283.72 423.704 283.62 L 423.704 226.72 C 423.704 220.92 428.404 216.22 434.204 216.22 L 442.604 216.22 L 442.604 232.22 C 442.604 232.42 442.904 232.52 443.004 232.42 C 446.604 229.22 451.104 227.72 456.704 227.72 C 471.904 227.72 483.004 239.92 482.904 256.52 C 482.904 273.22 471.904 285.12 456.604 285.12 C 449.804 285.12 444.704 283.02 441.304 278.62 C 441.204 278.42 440.904 278.52 440.904 278.72 L 440.904 278.92 C 440.904 281.62 438.704 283.82 436.004 283.82 L 423.904 283.82"
            style=""
        />
        <path
            id="first"
            class="st4"
            d="M 378.31 252.403 C 378.21 252.503 378.01 252.503 378.01 252.403 L 376.21 250.003 C 372.11 244.403 374.01 236.403 380.31 233.503 C 384.21 231.703 388.51 230.803 393.31 230.803 C 407.91 230.803 417.01 238.903 417.01 254.003 L 417.01 278.303 C 417.01 281.603 414.31 284.303 411.01 284.303 L 400.61 284.303 L 400.61 280.003 C 396.71 283.703 391.71 285.503 385.61 285.503 C 374.21 285.503 367.61 278.103 367.61 269.303 C 367.61 259.603 375.41 253.703 388.11 253.703 L 399.11 253.703 L 399.11 252.903 C 399.11 248.803 396.61 246.203 391.21 246.203 C 386.61 246.203 383.21 248.103 378.31 252.403 M 399.11 264.803 L 390.61 264.803 C 387.61 264.803 385.81 266.303 385.81 268.803 C 385.81 271.303 387.81 272.903 391.11 272.903 C 395.71 272.903 399.01 270.003 399.01 265.303 L 399.01 264.803 L 399.11 264.803 Z"
        />
        <path
            id="first"
            d="M 517.801 228.469 C 540.171 229.309 553.244 254.046 541.336 272.998 C 529.425 291.954 501.465 290.908 491.006 271.116 C 488.792 266.929 487.634 262.264 487.637 257.525 C 487.883 241.146 501.424 228.104 517.801 228.469 Z M 517.91 245.997 C 511.64 245.945 506.667 251.274 507.154 257.525 C 506.586 263.81 511.603 269.193 517.91 269.061 C 524.129 269.021 529.016 263.728 528.557 257.525 C 528.975 251.34 524.111 246.072 517.91 245.995 L 517.91 245.997 Z"
            style=""
        />
        <path
            id="first"
            d="M 603.583 258.579 L 603.583 238.472 C 603.583 231.224 595.737 226.697 589.462 230.321 C 586.55 232 584.755 235.11 584.755 238.472 L 584.755 259.776 C 584.916 265.973 578.307 270.02 572.861 267.062 C 570.201 265.617 568.574 262.802 568.653 259.776 L 568.653 238.472 C 568.653 231.226 560.807 226.697 554.533 230.321 C 551.619 232.003 549.826 235.11 549.826 238.472 L 549.826 258.576 C 549.657 279.27 571.947 292.385 589.953 282.188 C 598.443 277.378 603.663 268.337 603.583 258.576 L 603.583 258.579 Z"
            style=""
        />
        <path
            id="first"
            d="M 633.763 273.069 C 627.94 273.069 625.813 271.44 625.813 267.105 L 625.813 253.984 C 625.813 253.84 625.934 253.723 626.082 253.725 L 631.239 253.725 C 634.921 253.784 637.994 250.99 638.199 247.39 C 638.297 243.732 635.292 240.711 631.548 240.711 L 626.082 240.711 C 625.937 240.711 625.816 240.596 625.816 240.451 L 625.816 238.917 C 625.813 234.178 622.071 230.241 617.237 229.898 C 617.008 229.879 616.782 229.864 616.553 229.864 L 610.121 229.864 C 610.012 229.864 609.924 229.952 609.924 230.056 L 609.924 268.638 C 609.924 280.839 617.221 286.987 630.252 286.987 C 633.397 286.988 636.528 286.621 639.584 285.9 L 639.584 278.588 C 639.587 275.467 636.948 272.969 633.763 273.066 L 633.763 273.069 Z"
            style=""
        />
        <path
            id="first"
            d="M 543.2 181.419 C 547.351 185.808 553.063 188.374 559.096 188.561 C 562.439 188.561 564.166 187.754 564.166 186.026 C 564.166 184.76 563.242 184.185 560.825 183.146 L 554.377 180.497 C 542.974 175.889 537.67 171.051 537.67 161.954 C 537.67 150.55 546.541 143.869 560.02 143.869 C 566.187 143.657 572.276 145.341 577.458 148.697 C 579.936 150.436 580.449 153.898 578.587 156.282 L 572.344 164.372 C 569.021 161.277 564.675 159.517 560.136 159.418 C 557.485 159.418 556.103 160.109 556.103 161.606 C 556.103 162.872 557.257 163.681 560.02 164.716 L 565.779 167.021 C 577.298 171.63 582.599 176.006 582.599 185.108 C 582.807 190.603 580.311 195.853 575.916 199.16 C 570.906 202.691 564.876 204.471 558.752 204.228 C 550.983 204.409 543.412 201.779 537.429 196.824 C 535.332 194.959 535.058 191.78 536.801 189.582 L 543.2 181.419 Z"
            style=""
        />
      </svg>
    </div>
    <div v-else class="spinner-border" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>
</template>

<script lang="ts">
import { Component, Prop, Emit, Vue } from 'vue-facing-decorator'

@Component
export default class LoadingComponent extends Vue {
  @Prop({ required: true }) active!: boolean
  @Prop({ default: false }) canCancel!: boolean
  @Prop({ default: 100 }) size!: number | string // Default size is 100 (can be vh or px)
  @Prop({ default: 1 }) transparency!: number // Default transparency is 1 (fully opaque)
  @Prop({ default: false }) showLogo!: boolean // Default transparency is 1 (fully opaque)

  @Emit('update:active')
  updateActive(newValue: boolean) {
    return newValue
  }

  watchActive(newValue: boolean) {
    if (!newValue && this.canCancel) {
      this.updateActive(false)
    }
  }

  mounted() {
    this.$watch('active', this.watchActive)
    if (this.showLogo)
      setTimeout(() => {
        const preloader = document.getElementById('preloader')

        if (preloader) {
          preloader.style.transition = 'opacity 1s'
          preloader.style.opacity = '0'

          setTimeout(() => {
            document.documentElement.classList.remove('preloader')
            preloader.remove()
          }, 1000)
        }
      }, 2500)
  }

  get getStyle() {
    const sizeValue = typeof this.size === 'number' ? `${this.size}vh` : this.size
    return `height: ${sizeValue}; opacity: ${this.transparency};`
  }
}
</script>

<style scoped>
html.preloader {
  overflow: hidden;
}

@media (min-width: 992px) {
  .preloader .header-area {
    /*         margin-right: 17px; */
  }

  .preloader body {
    width: calc(100% + 17px);
  }
}

#preloader {
  background: white;
  position: fixed;
  z-index: 6;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

#preloader path {
  stroke-width: 1px;
}

@keyframes dash {
  0% {
    fill: white;
  }

  90% {
    fill: white;
  }

  100% {
    fill: #333334;
    stroke-dashoffset: 0;
  }
}

@keyframes dash2 {
  0% {
    fill: none;
  }

  90% {
    fill: none;
  }

  100% {
    fill: transparent;
    stroke-dashoffset: 0;
  }
}

path#first {
  stroke-dasharray: 250 250;
  stroke-dashoffset: -250;
  animation-duration: 2s;
  animation-name: dash;
  animation-fill-mode: forwards;
  fill: none;
  stroke: #333334;
}

path#second,
path#eight {
  stroke-dasharray: 250 250;
  stroke-dashoffset: -250;
  animation-duration: 2s;
  animation-name: dash;
  animation-fill-mode: forwards;
  fill: none;
  stroke: #333334;
}

path#third {
  stroke-dasharray: 423 423;
  stroke-dashoffset: -423;
  animation-duration: 2s;
  animation-name: dash;
  animation-fill-mode: forwards;
  fill: none;
  stroke: #333334;
}

path#fourth,
path#seventh,
path#sixth {
  stroke-dasharray: 250 250;
  stroke-dashoffset: -250;
  animation-duration: 2s;
  animation-name: dash;
  animation-fill-mode: forwards;
  fill: none;
  stroke: #333334;
}

#preloader svg {
  width: 200px;
}

@media (max-width: 768px) {
  #preloader svg {
    width: 130px;
  }
}

path#bw {
  stroke-dasharray: 373 373;
  stroke-dashoffset: -373;
  animation-duration: 2s;
  animation-name: dash2;
  animation-fill-mode: forwards;
  fill: none;
  stroke: #57bc70;
}

@keyframes dash2 {
  0% {
    fill: none;
  }

  90% {
    fill: none;
  }

  100% {
    fill: transparent;
    stroke-dashoffset: 0;
  }
}

@keyframes st0 {
  0% {
    fill: none;
  }

  90% {
    fill: none;
  }

  100% {
    fill: url(#SVGID_1_);
  }
}

path.st0 {
  animation-duration: 2s;
  animation-name: st0;
  animation-fill-mode: forwards;
}

@keyframes st1 {
  0% {
    fill: none;
  }

  90% {
    fill: none;
  }

  100% {
    fill: url(#SVGID_2_);
  }
}

path.st1 {
  animation-duration: 2s;
  animation-name: st1;
  animation-fill-mode: forwards;
}

@keyframes st2 {
  0% {
    fill: none;
  }

  90% {
    fill: none;
  }

  100% {
    fill: url(#SVGID_3_);
  }
}

path.st2 {
  animation-duration: 2s;
  animation-name: st2;
  animation-fill-mode: forwards;
}

@keyframes st3 {
  0% {
    fill: none;
  }

  90% {
    fill: none;
  }

  100% {
    fill: url(#SVGID_4_);
  }
}

path.st3 {
  animation-duration: 2s;
  animation-name: st3;
  animation-fill-mode: forwards;
}
</style>
